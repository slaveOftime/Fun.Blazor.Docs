<h2 id="how-does-this-work">How does this work?</h2>
<p>Fun.Blazor provides a series of delegates for Blazor to handle. For example, when you write:</p>
<pre><code class="language-fsharp">let demo =
    div {
        class' &quot;cool&quot;
    }
</code></pre>
<p>This code essentially becomes:</p>
<pre><code class="language-fsharp">let demo =
    NodeRenderFragment(fun comp builder index -&gt;  // delegate
        builder.OpenElement(index, &quot;div&quot;)
        bulder.AddAttribute(index + 1, &quot;class&quot;, &quot;cool&quot;)
        builer.CloseElement()
        index + 2
    )

type NodeRenderFragment = delegate of root: IComponent * builder: RenderTreeBuilder * sequence: int -&gt; int
</code></pre>
<p>In essence, you have created a delegate that will be passed to a component, which will manage the rendering or building of the DOM tree. This approach is similar to what the Razor engine would generate in the C# world.</p>
<p>Components can be created using <code>adaptiview</code>, <code>html.inject</code>, etc. These components are normal Blazor components that inherit from <code>ComponentBase</code>.</p>
<h2 id="considerations-before-using-fun.blazor">Considerations before using Fun.Blazor:</h2>
<p>There are a few things to keep in mind:</p>
<ol>
<li><p>The F# compiler has performance issues with intellisense for some large computation expressions (CEs). It is better to keep single CE blocks and files small, or use sequences like <code>seq</code>, <code>list</code>, or <code>array</code> with <code>childContent</code> for better intellisense:</p>
<pre><code class="language-fsharp">div {
    attributes ...
    childContent [ // ✅ recommended for more than one child item
        div { &quot;hi&quot; }
        ...a lot of child items
    ]
}
</code></pre>
<p>instead of:</p>
<pre><code class="language-fsharp">div {
    attributes ...
    div { &quot;hi&quot; }
    ...a lot of child items  ❌
}
</code></pre>
</li>
<li><p>Hot-reload</p>
<p>The default templates provide limited hot-reload support. Too many files can slow down the hot-reload process, so for best results, add <code>// hot-reload</code> at the top of files you want to enable hot-reload for. For more information, see the <a href="https://www.slaveoftime.fun/blog/d959e36a-f4fe-4a10-88af-5e738633db0f?title=%20Hot-reload%20in%20Fun.Blazor">Hot-reload in Fun.Blazor</a> blog post or <a href="https://slaveoftime.github.io/Fun.Blazor.Docs/?doc=/Hot%20Reload">document</a>.</p>
</li>
<li><p>Attribute, items position in CE</p>
<p>When using a <code>ref</code> or <code>renderMode</code> attribute etc., you should place it like below, because blazor treat them very special and can only add them after other attributes:</p>
<pre><code class="language-fsharp">div {
    attributes ...
    ref (fun x -&gt; ()) // ✅
    childContent [ ... ]
}
</code></pre>
<p>Or:</p>
<pre><code class="language-fsharp">div {
    attributes ...
    ref (fun x -&gt; ()) // ✅
    div { 1 }
    div { 1 }
    // ...
}
</code></pre>
</li>
</ol>
<h2 id="benchmarks">Benchmarks</h2>
<p>BenchmarkDotNet v0.13.10, Windows 11 (10.0.22621.2428/22H2/2022Update/SunValley2)
Intel Core i7-1065G7 CPU 1.30GHz, 1 CPU, 8 logical and 4 physical cores
.NET SDK 8.0.100-rc.2.23502.2
[Host]     : .NET 8.0.0 (8.0.23.47906), X64 RyuJIT AVX2 DEBUG
DefaultJob : .NET 8.0.0 (8.0.23.47906), X64 RyuJIT AVX2</p>
<table>
<thead>
<tr>
<th>Method</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Error</th>
<th style="text-align: right;">StdDev</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Gen0</th>
<th style="text-align: right;">Allocated</th>
</tr>
</thead>
<tbody>
<tr>
<td>RenderWithRazorCSharp</td>
<td style="text-align: right;">580.4 ns</td>
<td style="text-align: right;">24.14 ns</td>
<td style="text-align: right;">70.41 ns</td>
<td style="text-align: right;">566.4 ns</td>
<td style="text-align: right;">0.0935</td>
<td style="text-align: right;">392 B</td>
</tr>
<tr>
<td>RenderWithFunBlazorCE</td>
<td style="text-align: right;">677.9 ns</td>
<td style="text-align: right;">11.49 ns</td>
<td style="text-align: right;">18.23 ns</td>
<td style="text-align: right;">675.5 ns</td>
<td style="text-align: right;">0.1774</td>
<td style="text-align: right;">744 B</td>
</tr>
<tr>
<td>RenderWithBolero</td>
<td style="text-align: right;">905.4 ns</td>
<td style="text-align: right;">34.92 ns</td>
<td style="text-align: right;">102.95 ns</td>
<td style="text-align: right;">872.0 ns</td>
<td style="text-align: right;">0.3567</td>
<td style="text-align: right;">1496 B</td>
</tr>
</tbody>
</table>
