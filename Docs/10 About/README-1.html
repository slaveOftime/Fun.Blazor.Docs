<h2 id="benchmarks">Benchmarks</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Error</th>
<th style="text-align: right;">StdDev</th>
<th style="text-align: right;">Gen 0</th>
<th style="text-align: right;">Allocated</th>
</tr>
</thead>
<tbody>
<tr>
<td>RenderWithRazorCSharp</td>
<td style="text-align: right;">400.3 ns</td>
<td style="text-align: right;">6.99 ns</td>
<td style="text-align: right;">6.20 ns</td>
<td style="text-align: right;">0.0610</td>
<td style="text-align: right;">384 B</td>
</tr>
<tr>
<td>RenderWithBolero</td>
<td style="text-align: right;">926.1 ns</td>
<td style="text-align: right;">17.49 ns</td>
<td style="text-align: right;">17.96 ns</td>
<td style="text-align: right;">0.2546</td>
<td style="text-align: right;">1,600 B</td>
</tr>
<tr>
<td>RenderWithFunBlazorCE</td>
<td style="text-align: right;">731.1 ns</td>
<td style="text-align: right;">14.07 ns</td>
<td style="text-align: right;">21.49 ns</td>
<td style="text-align: right;">0.1173</td>
<td style="text-align: right;">736 B</td>
</tr>
<tr>
<td>RenderWithFunBlazorTemplate</td>
<td style="text-align: right;">2,569.9 ns</td>
<td style="text-align: right;">42.22 ns</td>
<td style="text-align: right;">39.50 ns</td>
<td style="text-align: right;">0.6752</td>
<td style="text-align: right;">4,240 B</td>
</tr>
</tbody>
</table>
<h2 id="how-is-this-work">How is this work</h2>
<p>Fun.Blazor's concept is very simple, provide a bunch of delegates to let <strong>blazor</strong> to handle.</p>
<p>When you write things like:</p>
<pre><code class="language-fsharp">let demo =
    div {
        class' &quot;cool&quot;
    }
</code></pre>
<p>Under the hood, it just becomes:</p>
<pre><code class="language-fsharp">let demo =
    NodeRenderFragment(fun comp builder index -&gt;
        builder.OpenElement(index, &quot;div&quot;)
        bulder.AddAttribute(index + 1, &quot;class&quot;, &quot;cool&quot;)
        builer.CloseElement()
        index + 2
    )

type NodeRenderFragment = delegate of root: IComponent * builder: RenderTreeBuilder * sequence: int -&gt; int
</code></pre>
<p>So basically, you just created a delegate and finally it will be passed to a component and let the component to manage when to render or build the dom tree. It is similar with what the razor engine will generate in csharp world.</p>
<p>The component can be created by <strong>adaptiview / html.comp / html.inject</strong> etc. Those components are just normal blazor components which are inherited from ComponentBase.</p>
<h2 id="before-you-consider-to-use-it">Before you consider to use it:</h2>
<p>There are some pitfalls which you may keep in mind:</p>
<ol>
<li><p>FSharp compiler has performance issue on intellisense for some large computation expression (CE). It is better to make single CE block smaller and single file smaller. Or use sequence like seq/list/array with childContent for better intellisense experience:</p>
<pre><code class="language-fsharp">div {
    attributes ...
    childContent [ // ✅ it is recommended to use this when you got more than one child items
        div { &quot;hi&quot; }
        ...a lot of child items
    ]
}
</code></pre>
<p>Instead of below:</p>
<pre><code class="language-fsharp">div {
    attributes ...
    div { &quot;hi&quot; }
    ...a lot of child items  ❌
}
</code></pre>
</li>
<li><p>Hot-reload</p>
<p>Now the default templates contain limited hot-reload support.
It is very slow to have too much file to be hot-reloaded, so you need to add <strong>// hot-reload</strong> at the top of the file you want to enable hot-reload.
For more detail you can check my blog post <a href="https://www.slaveoftime.fun/blog/d959e36a-f4fe-4a10-88af-5e738633db0f?title=%20Hot-reload%20in%20Fun.Blazor">Hot-reload in Fun.Blazor</a>.<br />
Or check the <a href="https://slaveoftime.github.io/Fun.Blazor.Docs/?doc=/Hot%20Reload">document</a></p>
</li>
<li><p>Attribute, items position in CE</p>
<p>When you want to use ref attribute, you need to put it like below</p>
<pre><code class="language-fsharp">div {
    onclick (fun _ -&gt; ())
    some other attibutes
    ref (fun x -&gt; ()) // ✅
    childContent [ ... ]
}
</code></pre>
<p>Or</p>
<pre><code class="language-fsharp">div {
    some other attibutes
    onclick (fun _ -&gt; ())
    ref (fun x -&gt; ()) // ✅
    div { 1 }
    div { 1 }
    // ...
}
</code></pre>
</li>
</ol>
